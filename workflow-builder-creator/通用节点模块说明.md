# 通用节点模块使用说明

## 概述

这是一个轻量级的通用节点模块，提供基本的节点创建、拖拽和连接功能。适用于需要简单节点图形界面的项目。

## 文件说明

- `node.js` - 核心节点模块类
- `node-module.html` - 独立使用示例  
- `demo.html` - 演示页面

## 基础用法

### 1. 初始化模块

```javascript
const container = document.getElementById('container');
const nodeModule = new NodeModule(container);
```

### 2. 创建节点

```javascript
// 创建默认节点
nodeModule.createNode(x, y);

// 创建自定义文本节点
nodeModule.createNode(x, y, '自定义文本');
```

### 3. 获取数据

```javascript
// 获取所有节点数据
const nodes = nodeModule.getNodes();

// 获取所有连接数据  
const connections = nodeModule.getConnections();
```

### 4. 清空画布

```javascript
nodeModule.clear();
```

## 功能特性

### ✅ 已实现功能
- **节点创建**：动态创建可拖拽节点
- **拖拽移动**：鼠标拖拽移动节点位置
- **连接功能**：点击连接点创建节点间连线
- **数据导出**：获取节点和连接的结构化数据
- **清空功能**：一键清除所有节点和连接

### 🎯 核心特点
- **轻量级**：单文件约200行代码
- **零依赖**：纯原生JavaScript实现
- **易集成**：简单的类接口，容易集成到其他项目
- **可定制**：节点样式通过CSS控制

## API 接口

### 构造函数
```javascript
new NodeModule(container)
```
- `container`: DOM元素，作为节点的容器

### 方法

#### createNode(x, y, text)
创建新节点
- `x`: 横坐标位置
- `y`: 纵坐标位置  
- `text`: 节点显示文本（可选）
- 返回: 创建的节点DOM元素

#### getNodes()
获取所有节点数据
- 返回: 节点数组，包含id、位置、文本信息

#### getConnections()
获取所有连接数据
- 返回: 连接数组，包含起始和结束节点信息

#### clear()
清空所有节点和连接

## 样式定制

节点外观通过CSS控制，主要类名：
- `.node` - 节点容器
- `.anchor` - 连接点
- `.anchor.left/right/top/bottom` - 各方向连接点

## 使用示例

### 基础示例
```html
<!DOCTYPE html>
<html>
<head>
    <title>节点模块示例</title>
</head>
<body>
    <div id="container" style="width: 100vw; height: 100vh; position: relative;"></div>
    
    <script src="node.js"></script>
    <script>
        const nodeModule = new NodeModule(document.getElementById('container'));
        
        // 创建三个节点
        nodeModule.createNode(100, 100, '开始');
        nodeModule.createNode(300, 100, '处理');
        nodeModule.createNode(500, 100, '结束');
    </script>
</body>
</html>
```

### 高级示例
```javascript
// 批量创建节点
const nodeData = [
    { x: 100, y: 100, text: '输入' },
    { x: 300, y: 100, text: '处理' },
    { x: 500, y: 100, text: '输出' }
];

nodeData.forEach(data => {
    nodeModule.createNode(data.x, data.y, data.text);
});

// 获取并保存数据
const saveData = () => {
    const data = {
        nodes: nodeModule.getNodes(),
        connections: nodeModule.getConnections()
    };
    localStorage.setItem('nodeData', JSON.stringify(data));
};
```

## 浏览器兼容性

- ✅ Chrome 60+
- ✅ Firefox 55+  
- ✅ Safari 12+
- ✅ Edge 79+

## 注意事项

1. **容器要求**：容器必须设置相对定位(`position: relative`)
2. **事件冲突**：避免在容器上添加其他鼠标事件监听器
3. **性能考虑**：大量节点时可能影响性能
4. **样式覆盖**：确保CSS样式不被其他样式覆盖

## 扩展建议

如需更多功能，可以考虑：
- 添加节点右键菜单
- 实现节点分组功能
- 添加连线标签
- 支持节点多选
- 实现撤销/重做功能

## 技术实现

- **拖拽**: 使用mousedown/mousemove/mouseup事件
- **连接**: SVG line元素绘制连接线
- **定位**: 绝对定位 + getBoundingClientRect()
- **数据**: Map和Array存储节点连接信息 